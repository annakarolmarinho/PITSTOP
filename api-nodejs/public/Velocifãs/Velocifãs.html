<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="png/favicon.ico">
    <title>PITSTOP |Velocifãs </title>
    <link rel="stylesheet" href="Velocifãs.css">
</head>

<body class="body">

    <div class="header">
        <div class="container-vermelho"> </div>
        <div class="container-header">
            <ul class="ul">
                <li id="aqui"><a href="HOME.html"> HOME </a></li>
                <li class="item"><a href="Equipes.html"> EQUIPES </a></li>
                <li class="item"><a href="Igualdade.html"> IGUALDADE </a></li>
                <li class="item"><a href="EnergiaLimpa.html"> ENERGIA LIMPA </a></li>
                <li class="item"><a href="../QuizTime/QuizTime.html"> QUIZTIME </a></li>
                <li class="item"><a href="../circuitos/circuitosMonaco.html"> CIRCUITOS </a></li>
                <li class="item"><a href="sobreMim.html"> SOBRE MIM </a></li>
                <li id="titulo"><a href="HOME.html">PITSTOP</a></li><img id="image" src="../png/LOGO2.png" alt="">

            </ul>
            <div class="cadastro-logo">
                <a href="Cadastro_login.html"><img id="image2" src="../png/cadastro.png" alt=""></a>
            </div>
        </div>
    </div>
    <div class="pesquisa">
        <div class="cabeçalho">
            <div class="texto1">Bem-vindo ao VelociFãs: Sua Voz na Fórmula 1!</div>
            <div class="texto2">
                Esta pesquisa é a sua oportunidade de compartilhar suas experiências, preferências e opiniões sobre a
                Fórmula 1. Queremos conhecer o seu piloto favorito e qual equipe
                faz seu coração acelerar. Seja parte desta comunidade apaixonada de fãs da F1 e ajude-nos a entender
                melhor
                o que torna este esporte tão especial para você.
            </div>
            <div class="tudo">

                <div class="formulario">
                    Formulário
                </div>


                <div class="input-box">
                    <label for="nome">Nome Completo:</label>
                    <input type="text" name="nome" id="input_nome" class="input-usuario" required>
                </div>
                <br>
                <div class="input-label">

                    <p>Gênero:</p>
                    <input type="radio" id="feminino" name="genero" value="feminino" required>
                    <label class="check" for="feminino">Feminino</label>

                    <input type="radio" id="Masculino" name="genero" value="masculino" required>
                    <label class="check" for="Masculino">Masculino</label>

                    <input type="radio" id="Outro" name="genero" value="outro" required>
                    <label class="check" for="Outro">Outro</label>
                    <br><br>
                    <div class="input-box">
                        <label for="data_nascimento">Ano de Nascimento:</label> <br>
                        <input type="date" name="data_nascimento" id="input_data_nascimento" class="input-usuario"
                            required>
                    </div>
                </div>

                <div class="input-box">
                    <label for="nome">Piloto favorito:</label><br>
                    <select name="nome" id="input_pilotoFavorito">
                        <option value="Lando">Lando Norris</option>
                        <option value="Oscar Piastri">Oscar Piastri</option>
                        <option value="Lewis Hamilton">Lewis Hamilton</option>
                        <option value="George Russel"> George Russel</option>
                        <option value="Max Verstappen">Max Verstappen</option>
                        <option value="Sergio Pérez">Sergio Pérez</option>
                        <option value="Charles Leclerc">Charles Leclerc</option>
                        <option value="Carlos Sainz">Carlos Sainz</option>
                        <option value="Esteban Ocon">Esteban Ocon</option>
                        <option value="Pierre Gasly">Pierre Gasly</option>
                        <option value="Valteri Bottas">Valteri Bottas</option>
                        <option value="Guanyu Zhou">Guanyu Zhou</option>
                        <option value="Lance Sroll">Lance Sroll</option>
                        <option value="Fernando Alonso">Fernando Alonso</option>
                        <option value="Yuki Tsunoda">Yuki Tsunoda</option>
                        <option value="Daniel Ricciardo">Daniel Ricciardo</option>
                        <option value="Alexander Albon">Alexander Albon</option>
                        <option value="Logan Sargeant">Logan Sargeant</option>
                        <option value="Kevin Magnussen">Kevin Magnussen</option>
                        <option value="Nico Hulkenberg">Nico Hulkenberg</option>
                    </select>
                </div>
                <div class="input-box">
                    <label for="nome">Equipe que torce:</label><br>
                    <select name="nome" id="input_EquipeQueTorce">
                        <option value="McLaren">McLaren</option>
                        <option value="Mercedes">Mercedes</option>
                        <option value="Ferrari">Ferrari</option>
                        <option value="RedBull">RedBull</option>
                        <option value="Alpine">Alpine</option>
                        <option value="Aston Martin">Aston Martin</option>
                        <option value="AlphaTauri">AlphaTauri</option>
                        <option value="Hass">Hass</option>
                        <option value="Alfa Romeo">Alfa Romeo</option>
                        <option value="Williams">Williams</option>
                    </select>
                </div>
                <br>
                <p>Já assistiu alguma corrida ao Vivo?</p>
                <input type="radio" id="sim" name="simNao" value="sim" required>
                <label class="check" for="sim">sim</label>
                <input type="radio" id="nao" name="simNao" value="nao" required>
                <label class="check" for="nao">não</label>
            </div>
        </div>
        <button class="submit" type="submit" name="submit" id="submit" onclick="submit()"> Enviar </button>
    </div>




</body>

</html>
<script>

    function submit() {

        var idUsuario = sessionStorage.ID_USUARIO;
    
        if (idUsuario === null || idUsuario === undefined || idUsuario.trim() === "") {
            sessionStorage.LATEST_NAME = window.location.pathname;
            window.location = '../cadastro/Cadastro_login.html';
            return;
        }

        console.log(idUsuario);

        var nomeCompleto = input_nome.value;
        var genero;

        if (document.getElementById('feminino').checked) {
            genero = document.getElementById('feminino').value;
        }
        if (document.getElementById('Masculino').checked) {
            genero = document.getElementById('Masculino').value;
        }
        if (document.getElementById('Outro').checked) {
            genero = document.getElementById('Outro').value;
        }

        var dataNascimento = input_data_nascimento.value;
        var pilotoSelecionado = document.getElementById("input_pilotoFavorito").value;
        var equipeSelecionada = document.getElementById("input_EquipeQueTorce").value;
        var corridaAoVivo;

        if (document.getElementById('sim').checked) {
            corridaAoVivo = document.getElementById('sim').value;
        }
        if (document.getElementById('nao').checked) {
            corridaAoVivo = document.getElementById('nao').value;
        }
        // var listaErros = validarFormulario(nomeCompleto, genero, dataNascimento, pilotoFavorito, equipe, corridaAoVivo);
        // nomeLogin,

        // if (listaErros.length > 0) {
        //     let mensagem = "";
        //     for (var erro of listaErros) {
        //         mensagem += erro + '\n';
        //     }
        //     showErrorToast(mensagem);
        //     return;
        // }

        console.log("FORM NOME: ", nomeCompleto);
        console.log("FORM GENERO: ", genero);
        console.log("FORM DATA NASCIMENTO: ", dataNascimento);
        console.log("FORM PILOTO FAVORITO: ", pilotoSelecionado);
        console.log("FORM EQUIPE QUE TORCE: ", equipeSelecionada);
        console.log("FORM CORRIDA AO VIVO: ", corridaAoVivo);
        console.log('ID USUÁRIO: ' + idUsuario);

        fetch("/formulario/enviarFormulario", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                usuario: idUsuario,
                nomeFormulario: nomeCompleto,
                generoFormulario: genero,
                dtaNascimentoFormulario: dataNascimento,
                pilotoFavoritoFormulario: pilotoSelecionado,
                equipeQueTorceFormulario: equipeSelecionada,
                assistiuCorridaAoVivoFormulario: corridaAoVivo
            })

        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO formulario()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log("Chegou aqui");
                    console.log(json);
                    console.log(JSON.stringify(json));
                    sessionStorage.NOME_USUARIO = json[0].nomeCompleto;
                    sessionStorage.GENERO_USUARIO = json[0].genero;
                    sessionStorage.DTA_NASCIMENTO_USUARIO = json[0].idUsuario;
                    sessionStorage.PILOTO_FAVORITO_USUARIO = json[0].pilotoFavorito;
                    sessionStorage.EQUIPE_USUARIO = json[0].equipe;
                    sessionStorage.ASSISTIU_CORRIDA_USUARIO = json[0].corridaAoVivo;
                    sessionStorage.ID_USUARIO = json[0].idUsuario;


                    setTimeout(function () {
                        window.location = "index.html";
                    }, 1000); // apenas para exibir o loading

                });

            } else {

                console.log("Houve um erro ao enviar o formulario!");

                if (resposta.status == 403) {
                    showErrorToast(' informações inválidas');
                }

                resposta.text().then(texto => {
                    console.error(texto);
                    // finalizarAguardar(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        });
    }

    // function obterGeneroSelecionado() {
    //     // Obter todos os inputs de rádio com name "genero"
    //     // let opcoesGenero = document.getElementsByName("genero");

    //     // Iterar sobre os inputs e verificar qual está selecionado
    //     for (var i = 0; i < genero.length; i++) {
    //         if (genero[i].checked) {
    //             // O valor do input selecionado
    //             var generoSelecionado = genero[i].value;

    //             // Use o valor conforme necessário (por exemplo, imprimir no console)
    //             console.log("Gênero selecionado: " + generoSelecionado);

    //             // Pode retornar o valor se quiser utilizá-lo em outros lugares
    //             return generoSelecionado;
    //         }
    //     }

    //     // Se nenhum gênero estiver selecionado
    //     console.log("Nenhum gênero selecionado");
    //     return null;
    // }





    function showErrorToast(message) {
        var toast = document.getElementById("errorToast");
        toast.classList.add("show-toast");

        toast.innerHTML = message;

        setTimeout(function () {
            toast.classList.remove("show-toast");
        }, 3000);
    }

    // function validarFormulario(email, senha) {

    //     var listaErros = [];

    //     if (!validarEmail(email)) {
    //         listaErros.push('Por favor, insira um email válido.');
    //     }

    //     if (senha.length < 6) {
    //         listaErros.push('A senha deve ter pelo menos 6 caracteres.');
    //     }

    //     return listaErros;
    // }

    // function validarEmail(email) {
    //     var indiceArroba = email.indexOf('@');
    //     var indicePonto = email.lastIndexOf('.');

    //     if (indiceArroba < 0 || indicePonto < 0 || indiceArroba > indicePonto || indiceArroba === 0 || indicePonto === email.length - 1) {
    //         return false;
    //     }

    //     return true;
    // }
</script>